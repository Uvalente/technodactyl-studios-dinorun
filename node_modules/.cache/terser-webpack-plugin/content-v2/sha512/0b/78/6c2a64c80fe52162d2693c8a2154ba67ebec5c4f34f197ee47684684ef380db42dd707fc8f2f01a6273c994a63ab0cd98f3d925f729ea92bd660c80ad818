{"map":{"version":3,"sources":["js/mp3_analysis/mp3_info-987ce5f83108286fb729.js"],"names":["modules","installedModules","__webpack_require__","moduleId","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","12","__webpack_exports__","_defineProperties","target","props","length","descriptor","configurable","writable","SongAnalyser","instance","Constructor","TypeError","_classCallCheck","this","protoProps","staticProps","song","audio_file","document","getElementById","onchange","hideCreateSongButton","displayProgressBar","file","files","song_title","reader","FileReader","context","window","AudioContext","webkitAudioContext","onload","decodeAudioData","result","buffer","json","readAsArrayBuffer","offlineContext","OfflineAudioContext","sampleRate","source","createBufferSource","filter","createBiquadFilter","type","connect","destination","start","self","startRendering","then","lowPassAudioBuffer","audioCtx","songLength","duration","lowPassBuffer","getChannelData","gettingTempo","getSampleClip","normalizeArray","finalTempo","countFlatLineGroupings","song_bpm","console","log","Number","isNaN","song_analysed","JSON","stringify","showCreateSongButton","data","samples","newArray","modulus_coefficient","Math","round","push","abs","max","a","getMax","min","Infinity","getMin","count","threshold","querySelector","innerHTML","style","display"],"mappings":"CAAS,SAAUA,GAET,IAAIC,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAJ,EAAQG,GAAUK,KAAKH,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QAKfF,EAAoBO,EAAIT,EAGxBE,EAAoBQ,EAAIT,EAGxBC,EAAoBS,EAAI,SAASP,EAASQ,EAAMC,GAC3CX,EAAoBY,EAAEV,EAASQ,IAClCG,OAAOC,eAAeZ,EAASQ,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEX,EAAoBiB,EAAI,SAASf,GACX,qBAAXgB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeZ,EAASgB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeZ,EAAS,aAAc,CAAEkB,OAAO,KAQvDpB,EAAoBqB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQpB,EAAoBoB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,kBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFAzB,EAAoBiB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOpB,EAAoBS,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRxB,EAAoB4B,EAAI,SAASzB,GAChC,IAAIQ,EAASR,GAAUA,EAAOoB,WAC7B,WAAwB,OAAOpB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBS,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRX,EAAoBY,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG9B,EAAoBiC,EAAI,UAIjBjC,EAAoBA,EAAoBkC,EAAI,IAnFpD,CAsFC,CAEJC,GACA,SAAUhC,EAAQiC,EAAqBpC,GAE7C,aAEiJ,SAASqC,EAAkBC,EAAOC,GAAO,IAAI,IAAInC,EAAE,EAAEA,EAAEmC,EAAMC,OAAOpC,IAAI,CAAC,IAAIqC,EAAWF,EAAMnC,GAAGqC,EAAW1B,WAAW0B,EAAW1B,aAAY,EAAM0B,EAAWC,cAAa,EAAQ,UAAUD,IAAWA,EAAWE,UAAS,GAAK9B,OAAOC,eAAewB,EAAOG,EAAWf,IAAIe,IAD/ZzC,EAAoBiB,EAAEmB,GACimB,IAAIQ,EAA0B,WAAW,SAASA,KAAzqB,SAAyBC,EAASC,GAAa,KAAKD,aAAoBC,GAAc,MAAM,IAAIC,UAAU,qCAA8kBC,CAAgBC,KAAKL,GAAhS,IAAsBE,EAAYI,EAAWC,EAI0jC,OAJjlCL,EAAsSF,GAA1RM,EAAuS,CAAC,CAACxB,IAAI,QAAQN,MAAM,WAAiB,IAAIgC,EAAKH,KAASI,EAAWC,SAASC,eAAe,YAAYF,EAAWG,SAAS,WAAW,GAAqB,IAAlBH,EAAWjC,MAAW,MAAM,GAAIgC,EAAKK,uBAAuBL,EAAKM,qBAAqB,IAAIC,EAAKV,KAAKW,MAAM,GAAGC,WAAWzC,MAAMuC,EAAKjD,KAAK,IAAIoD,EAAO,IAAIC,WAAiBC,EAAQ,IAAIC,OAAOC,cAAcD,OAAOE,oBAAsBL,EAAOM,OAAO,WAAWJ,EAAQK,gBAAgBP,EAAOQ,QAAO,SAASC,GAAQnB,EAAKoB,KAAKD,OAAaT,EAAOW,kBAAkBd,MACluC,CAACjC,IAAI,OAAON,MAAM,SAAcmD,GAAQ,IAAIG,EAAe,IAAIC,oBAAoB,EAAEJ,EAAO/B,OAAO+B,EAAOK,YAAgBC,EAAOH,EAAeI,qBAAqBD,EAAON,OAAOA,EAAO,IAAIQ,EAAOL,EAAeM,qBAAqBD,EAAOE,KAAK,UAAUJ,EAAOK,QAAQH,GAAQA,EAAOG,QAAQR,EAAeS,aAAaN,EAAOO,MAAM,GAAGC,KAAKpC,KAAKyB,EAAeY,iBAAiBC,MAAK,SAASC,GAAoB,IAAIC,EAAS,IAAIxB,OAAOC,cAAcD,OAAOE,oBAA0Bf,EAAKqC,EAASX,qBAAqB1B,EAAKmB,OAAOiB,EAAmB,IAAIE,EAAWtC,EAAKmB,OAAOoB,SAASvC,EAAK8B,QAAQO,EAASN,aAAa,IAAIS,EAAcxC,EAAKmB,OAAOsB,eAAe,GACxpBC,EAAaT,KAAKU,cAAcH,EAAc,KAAKE,EAAaT,KAAKW,eAAeF,GAAc,IAAwDG,EAAiB,EAA/DZ,KAAKa,uBAAuBJ,GAAqCK,SAAS/E,MAAM6E,EAAWG,QAAQC,IAAI,MAAMJ,GAC7NL,EAAcP,KAAKU,cAAcH,EAAcK,EAAWP,EAAW,IAAqDE,GAAjDA,EAAcP,KAAKW,eAAeJ,IAA2Cb,QAAO,SAAS3D,GAAO,OAAOkF,OAAOC,MAAMnF,MAAUgF,QAAQC,IAAI,eAAeT,GAAeY,cAAcpF,MAAMqF,KAAKC,UAAUd,GACxRP,KAAKsB,4BAA6B,CAACjF,IAAI,gBAAgBN,MAAM,SAAuBwF,EAAKC,GAAiF,IAAxE,IAAIC,EAAS,GAAOC,EAAoBC,KAAKC,MAAML,EAAKpE,OAAOqE,GAAiBzG,EAAE,EAAEA,EAAEwG,EAAKpE,OAAOpC,IAAQA,EAAE2G,GAAqB,GAAGD,EAASI,KAAKN,EAAKxG,IAAM,OAAO0G,IAAY,CAACpF,IAAI,iBAAiBN,MAAM,SAAwBwF,GAAsB,IAAhB,IAAIE,EAAS,GAAW1G,EAAE,EAAEA,EAAEwG,EAAKpE,OAAOpC,IAAK0G,EAASI,KAAKF,KAAKG,IAAIH,KAAKC,MAA0B,KAAnBL,EAAKxG,EAAE,GAAGwG,EAAKxG,OAAa,OAAO0G,IAAY,CAACpF,IAAI,yBAAyBN,MAAM,SAAgCwF,GAAgW,IAA1V,IAAoBE,EAAS7D,KAAK+C,eAAeY,GAAuMQ,EAAjM,SAAgBC,GAAkC,IAA/B,IAAI9G,GAAE,EAAA,EAAUH,EAAE,EAAEwB,EAAEyF,EAAE7E,OAAYpC,GAAGwB,IAAIxB,EAAMiH,EAAEjH,GAAGG,IAAGA,EAAE8G,EAAEjH,IAAK,OAAOG,EAAyG+G,CAAOR,GAAcS,EAA3H,SAAgBF,GAAiC,IAA9B,IAAI9G,EAAEiH,EAAAA,EAASpH,EAAE,EAAEwB,EAAEyF,EAAE7E,OAAYpC,GAAGwB,IAAIxB,EAAMiH,EAAEjH,GAAGG,IAAGA,EAAE8G,EAAEjH,IAAK,OAAOG,EAAoCkH,CAAOX,GAAcY,EAAM,EAAMC,EAAUX,KAAKC,MAAgB,IAATG,EAAIG,IAAkBnH,EAAE,EAAEA,EAAE0G,EAAStE,OAAOpC,IAAQ0G,EAAS1G,GAAGuH,GAAWb,EAAS1G,EAAE,GAAGuH,GAAWb,EAAS1G,EAAE,GAAGuH,GAAWb,EAAS1G,EAAE,GAAGuH,GAAWb,EAAS1G,EAAE,GAAGuH,GAAWD,IAAU,OAAOA,IAAS,CAAChG,IAAI,uBAAuBN,MAAM,WAAgCkC,SAASsE,cAAc,yBAAyBC,UAAU,GAAGvE,SAASsE,cAAc,oBAAoBE,MAAMC,QAAQ,iBAAkB,CAACrG,IAAI,uBAAuBN,MAAM,WAAgCkC,SAASsE,cAAc,oBAAoBE,MAAMC,QAAQ,SAAU,CAACrG,IAAI,qBAAqBN,MAAM,WAA8BkC,SAASsE,cAAc,yBAAyBC,UAAU,iCAJ9/BxF,EAAkBS,EAAYf,UAAUmB,GAAeC,GAAYd,EAAkBS,EAAYK,GAIq8BP,EAJt4B,GAIo7BR,EAA6B,QAAI"},"code":"!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){\"undefined\"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&\"object\"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&n&&\"string\"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p=\"/packs/\",t(t.s=12)}({12:function(e,n,t){\"use strict\";function r(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}t.r(n);var o=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError(\"Cannot call a class as a function\")}(this,e)}var n,t,o;return n=e,(t=[{key:\"setup\",value:function(){var e=this,n=document.getElementById(\"song_mp3\");n.onchange=function(){if(\"\"==n.value)return\"\";e.hideCreateSongButton(),e.displayProgressBar();var t=this.files[0];song_title.value=t.name;var r=new FileReader,o=new(window.AudioContext||window.webkitAudioContext);r.onload=function(){o.decodeAudioData(r.result,(function(n){e.json(n)}))},r.readAsArrayBuffer(t)}}},{key:\"json\",value:function(e){var n=new OfflineAudioContext(1,e.length,e.sampleRate),t=n.createBufferSource();t.buffer=e;var r=n.createBiquadFilter();r.type=\"lowpass\",t.connect(r),r.connect(n.destination),t.start(0),self=this,n.startRendering().then((function(e){var n=new(window.AudioContext||window.webkitAudioContext),t=n.createBufferSource();t.buffer=e;var r=t.buffer.duration;t.connect(n.destination);var o=t.buffer.getChannelData(0),a=self.getSampleClip(o,400);a=self.normalizeArray(a);var u=6*self.countFlatLineGroupings(a);song_bpm.value=u,console.log(\"bpm\",u),o=self.getSampleClip(o,u*r/60),o=(o=self.normalizeArray(o)).filter((function(e){return!Number.isNaN(e)})),console.log(\"buffer array\",o),song_analysed.value=JSON.stringify(o),self.showCreateSongButton()}))}},{key:\"getSampleClip\",value:function(e,n){for(var t=[],r=Math.round(e.length/n),o=0;o<e.length;o++)o%r==0&&t.push(e[o]);return t}},{key:\"normalizeArray\",value:function(e){for(var n=[],t=0;t<e.length;t++)n.push(Math.abs(Math.round(1e3*(e[t+1]-e[t]))));return n}},{key:\"countFlatLineGroupings\",value:function(e){for(var n=this.normalizeArray(e),t=function(e){for(var n=-1/0,t=0,r=e.length;t!=r;++t)e[t]>n&&(n=e[t]);return n}(n),r=function(e){for(var n=1/0,t=0,r=e.length;t!=r;++t)e[t]<n&&(n=e[t]);return n}(n),o=0,a=Math.round(.2*(t-r)),u=0;u<n.length;u++)n[u]>a&&n[u+1]<a&&n[u+2]<a&&n[u+3]<a&&n[u+6]<a&&o++;return o}},{key:\"showCreateSongButton\",value:function(){document.querySelector(\"#create_song_progress\").innerHTML=\"\",document.querySelector(\"#create_song_btn\").style.display=\"inline-block\"}},{key:\"hideCreateSongButton\",value:function(){document.querySelector(\"#create_song_btn\").style.display=\"none\"}},{key:\"displayProgressBar\",value:function(){document.querySelector(\"#create_song_progress\").innerHTML=\"Song analysis in progress\"}}])&&r(n.prototype,t),o&&r(n,o),e}();n.default=o}});","extractedComments":[]}